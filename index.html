<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Новий стиль в інвестуванні — MVP</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#4712a3;            /* фіолетовий фон героя та тесту */
      --accent:#4f46e5;        /* індиго */
      --accent-2:#22c55e;      /* зелений для прогресу */
      --text:#0b1020;          /* основний текст */
      --muted:#6b7280;         /* вторинний текст */
      --card:#ffffff;          /* картки */
      --ring:rgba(79,70,229,.2);
      --shadow:0 10px 25px rgba(2,6,23,.18), 0 2px 6px rgba(2,6,23,.12);
      --radius:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;color:var(--text);background:#fff}

    /* === HERO === */
    .hero{position:relative;min-height:100vh;display:grid;grid-template-columns:1.2fr 1fr}
    .hero__left{background:var(--bg);color:#fff;padding:64px 56px;display:flex;align-items:center}
    .hero__content{max-width:720px}
    .eyebrow{font-weight:600;opacity:.9;letter-spacing:.04em}
    h1{font-weight:800;font-size:clamp(28px,4vw,48px);line-height:1.06;margin:18px 0 12px}
    .lead{font-size:clamp(14px,1.2vw,18px);opacity:.92}
    .lead b{color:#fff}
    .cta-row{display:flex;gap:14px;margin-top:24px;flex-wrap:wrap}
    .btn{appearance:none;border:0;padding:16px 22px;border-radius:14px;background:#fff;color:#111;font-weight:800;cursor:pointer;box-shadow:var(--shadow);transition:.18s transform,.18s box-shadow;font-size:18px;min-height:52px;line-height:1.1}
    .btn:hover{transform:translateY(-1px)}
    .btn--ghost{background:transparent;border:1.5px solid rgba(255,255,255,.6);color:#fff}

    .hero__right{position:relative;background:#fff;display:flex;align-items:center;justify-content:center;overflow:hidden}
    .hero__art{max-width:min(560px,80%);aspect-ratio:1/1;display:block}

    /* Перекриття текстового блоку на праву частину (легкий оверлап) */
    .overlap{position:absolute;inset:auto -80px 24px auto;width:min(580px,46vw);background:rgba(255,255,255,.12);backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.18);padding:18px;border-radius:20px}
    .overlap p{margin:0;font-size:13px;opacity:.9}

    /* === QUIZ MODAL (full-screen) === */
    .quiz{position:fixed;inset:0;display:none;z-index:70}
    .quiz[aria-hidden="false"]{display:block}
    .quiz__backdrop{position:absolute;inset:0;background:rgba(17,24,39,.56);backdrop-filter:blur(4px)}
    .quiz__panel{position:absolute;inset:20px;display:grid;grid-template-rows:auto auto 1fr auto;gap:16px;background:var(--bg);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .quiz__top{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;background:transparent;border-bottom:1px dashed rgba(255,255,255,.18)}
    .quiz__title{font-weight:800;color:#ffffff}
    .quiz__progress-wrap{height:10px;background:#eef2ff;border-radius:999px;overflow:hidden;margin:0 18px}
    .quiz__progress{height:100%;width:0;background:var(--accent-2);transition:width .25s ease}

    .quiz__card{margin:12px 14px;background:var(--card);border-radius:16px;box-shadow:var(--shadow)}
    .quiz__q{padding:18px 18px 8px;font-weight:700}
    .quiz__answers{display:grid;gap:8px;padding:0 18px 18px}
    .opt{display:flex;align-items:flex-start;gap:10px;padding:16px 18px;border:1.5px solid #e5e7eb;border-radius:14px;cursor:pointer;transition:border-color .2s,box-shadow .2s;background:#fff;font-size:16px}
    .opt:hover{border-color:var(--accent);box-shadow:0 0 0 4px var(--ring)}
    .opt input{margin-top:2px}

    .quiz__footer{display:flex;justify-content:space-between;gap:12px;padding:14px 18px;background:#fff;border-top:1px dashed rgba(2,6,23,.08)}
    .btn-sec{border:1.5px solid #c7ccff;background:#eef2ff;color:#27309a}
    .btn-prim{background:var(--accent);color:#fff}
    .quiz__nav{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .quiz__footer .btn{min-width:160px}
    .quiz__nav .btn{min-width:140px}

    /* === RESULT + FORM === */
    .result{margin:12px 14px;background:#fff;border-radius:16px;box-shadow:var(--shadow);padding:16px;display:none}
    .result.show{display:block}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;background:#ecfdf5;color:#065f46;border:1px solid #a7f3d0}
    .muted{color:var(--muted)}

    form{display:grid;gap:12px;margin-top:8px}
    .fld{display:flex;flex-direction:column;gap:6px}
    .fld label{font-size:13px;color:#334155}
    .fld input,.fld select{padding:12px 14px;border:1.4px solid #d1d5db;border-radius:12px;font:inherit}
    .agree{display:flex;align-items:center;gap:10px;font-size:12px;color:#475569}
    .submit{padding:14px 18px;border-radius:12px;background:linear-gradient(90deg,#4f46e5,#7c3aed);border:0;color:#fff;font-weight:800;cursor:pointer;box-shadow:var(--shadow)}
    .note{font-size:12px;color:#64748b}
    .success{display:none;padding:12px 14px;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:12px;color:#065f46;font-weight:600}

    /* === RESPONSIVE === */
    @media (max-width: 980px){
      .hero{grid-template-columns:1fr;min-height:auto}
      .hero__left{min-height:72vh}
      .hero__right{padding:40px 0}
      .overlap{display:none}
      .hero__art{max-width:64%}
      .quiz__panel{inset:10px}
      .quiz__nav .btn, .quiz__footer .btn{flex:1}
    }
  </style>
</head>
<body>
  <!-- ================= HERO ================= -->
  <main class="hero">
    <section class="hero__left">
      <div class="hero__content">
        <div class="eyebrow">Безпечні інвестиції та фінансова впевненість</div>
        <h1>Новий стиль в інвестуванні</h1>
        <p class="lead">Інвестуйте так, як вам зручно — навіть невеликими сумами. <b>Безпечні інвестиції</b> та фінансова <b>впевненість</b> для людей 40–70 років. Отримайте <i>безкоштовну</i> рекомендацію аналітика за 2 хвилини.</p>
        <div class="cta-row">
          <button class="btn" onclick="openQuiz()">Хочу інвестувати безпечно</button>
          <a class="btn btn--ghost" href="#advantages">Переваги</a>
        </div>
      </div>
    </section>
    <section class="hero__right">
      <img class="hero__art" src="https://i.ibb.co/0Xj6m3t/investing-phone-illustration.png" alt="Investing illustration" />
      <div class="overlap"><p>Порада: спробуйте тест — він підкаже профіль та відправить рекомендацію на e‑mail. Можна закрити у будь-який момент.</p></div>
    </section>
  </main>

  <!-- =============== QUIZ FULLSCREEN =============== -->
  <div id="quiz" class="quiz" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="quiz__backdrop" onclick="closeQuiz()" aria-label="Закрити"></div>
    <div class="quiz__panel">
      <div class="quiz__top">
        <div class="quiz__title">Швидкий тест: знайдемо для вас безпечний план</div>
        <div class="quiz__nav">
          <button id="prevBtnTop" class="btn btn-sec" onclick="prevStep()" disabled>Назад</button>
          <button id="nextBtnTop" class="btn btn-prim" onclick="nextStep()">Далі</button>
          <button class="btn btn-sec" onclick="closeQuiz()">✕</button>
        </div>
      </div>
      <div class="quiz__progress-wrap" aria-hidden="true"><div id="progress" class="quiz__progress"></div></div>

      <!-- QUESTION CARD -->
      <div id="card" class="quiz__card" aria-live="polite"></div>

      <!-- RESULT + FORM -->
      <div id="result" class="result" aria-live="polite"></div>

      <div class="quiz__footer">
        <button id="prevBtn" class="btn btn-sec" onclick="prevStep()" disabled>Назад</button>
        <div style="display:flex;gap:8px">
          <button id="nextBtn" class="btn btn-prim" onclick="nextStep()">Далі</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  // ================= QUIZ LOGIC (IIFE + explicit window exports) =================
  (function(){
    const steps = [
      { q: '1) Скільки вам років?', name:'age', type:'radio', options:['від 20 до 40','від 40 до 75','75+'] },
      { q: '2) Чи можливо заробити на відпустку через інвестиції?', name:'vac', type:'radio', options:['можливо','не віриться','вже заробив, хочу ще'] },
      { q: '3) Що зараз вигідно купити для заробітку?', name:'asset', type:'radio', options:['золото','акції молодої компанії','хочу дізнатися у вас'] },
      { q: '4) Як правильно обрати партнера для інвестицій?', name:'partner', type:'radio', options:['перевірити документи','інвестувати маленьку суму','проконсультуватися з професіоналами','хочу дізнатися'] }
    ];

    let idx = 0;                         // поточний крок
    const state = {};                    // відповіді користувача

    const els = {
      quiz: document.getElementById('quiz'),
      card: document.getElementById('card'),
      result: document.getElementById('result'),
      progress: document.getElementById('progress'),
      prevBtn: document.getElementById('prevBtn'),
      nextBtn: document.getElementById('nextBtn'),
      prevBtnTop: document.getElementById('prevBtnTop'),
      nextBtnTop: document.getElementById('nextBtnTop')
    };

    function resetState(){ for(const k in state) delete state[k]; }

    function openQuiz(){
      els.quiz.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
      idx = 0; resetState();
      // повертаємо видимість нижніх кнопок, якщо ховали на екрані результату
      els.nextBtn.style.display = '';
      els.prevBtn.style.display = '';
      els.progress.style.width = '0%';
      renderStep();
    }

    function closeQuiz(){
      els.quiz.setAttribute('aria-hidden','true');
      document.body.style.overflow='auto';
    }

    function renderStep(){
      const step = steps[idx];
      els.result.classList.remove('show');

      // прогрес
      const pct = Math.round((idx) / steps.length * 100);
      els.progress.style.width = pct + '%';

      // кнопки
      const isFirst = idx === 0;
      const isLast  = idx === steps.length - 1;
      els.prevBtn.disabled    = isFirst;
      els.prevBtnTop.disabled = isFirst;
      const nextText = isLast ? 'Показати результат' : 'Далі';
      els.nextBtn.textContent    = nextText;
      els.nextBtnTop.textContent = nextText;

      // рендер питання
      const saved = state[step.name] ?? '';
      const opts = step.options.map((t,i)=>{
        const id = step.name + '_' + i;
        const checked = saved === t ? 'checked' : '';
        return `
          <label class="opt" for="${id}">
            <input id="${id}" type="radio" name="${step.name}" value="${t}" ${checked} />
            <span>${t}</span>
          </label>`
      }).join('');

      els.card.innerHTML = `
        <div class="quiz__q">${step.q}</div>
        <div class="quiz__answers">${opts}</div>`;

      // слухач вибору
      els.card.querySelectorAll('input[type="radio"]').forEach(inp=>{
        inp.addEventListener('change', (e)=>{ state[step.name] = e.target.value; })
      });

      // автофокус на перший інпут
      const first = els.card.querySelector('input');
      first && first.focus({preventScroll:true});
    }

    function nextStep(){
      const step = steps[idx];
      if(!state[step.name]){ bump(); return; }
      if(idx < steps.length - 1){ idx++; renderStep(); return; }
      showResult();
    }

    function prevStep(){ idx = Math.max(0, idx - 1); renderStep(); }

    // Легка анімація "підштовхування" кнопки при відсутності відповіді
    function bump(){
      [els.nextBtn, els.nextBtnTop].forEach(btn=>{
        if(!btn) return;
        btn.animate([
          {transform:'translateY(0)'},
          {transform:'translateY(-2px)'},
          {transform:'translateY(0)'}
        ],{duration:240});
      });
    }

    function profileFrom(state){
      // Дуже проста евристика під ваш MVP
      let score = 0;
      if(state.age === 'від 40 до 75' || state.age === '75+') score += 1;
      if(state.asset === 'золото') score += 2;                 // консервативно
      if(state.asset === 'акції молодої компанії') score -= 1; // агресивно
      if(state.partner === 'перевірити документи') score += 1;
      if(state.partner === 'проконсультуватися з професіоналами') score += 1;

      if(score >= 3) return {key:'conservative', title:'Консервативний профіль',
        rec:'Рекомендуємо консервативну стратегію: облігації, фонди нерухомості, золото/срібло. Поступове збільшення частки акцій після консультації.'}
      if(score <= 0) return {key:'aggr', title:'Помірно‑агресивний профіль',
        rec:'Можливе поєднання індексних фондів та частки акцій зростання. Захист: 30–40% у «якорях» (золото/облігації).'}
      return {key:'moderate', title:'Збалансований профіль',
        rec:'Збалансований портфель: 50–60% індексні фонди/великі компанії, 20–30% облігації, 10–20% метали. Регулярний ребаланс.'}
    }

    function showResult(){
      els.card.innerHTML = '';
      els.nextBtn.style.display = 'none';
      els.prevBtn.style.display = 'none';
      if(els.nextBtnTop) els.nextBtnTop.style.display = 'none';
      if(els.prevBtnTop) els.prevBtnTop.style.display = 'none';
      els.progress.style.width = '100%';

      const prof = profileFrom(state);
      const hiddenPayload = Object.entries(state)
        .map(([k,v])=>`<input type="hidden" name="${k}" value="${v}">`).join('') +
        `<input type="hidden" name="profile" value="${prof.title}">`;

      els.result.innerHTML = `
        <div class="badge">Результат: ${prof.title}</div>
        <p class="muted" style="margin:10px 0 14px">${prof.rec}</p>

        <form id="leadForm" action="https://formspree.io/f/XXXXXXXX" method="POST">
          ${hiddenPayload}
          <div class="fld"><label>Ім'я та прізвище</label><input required name="full_name" placeholder="Ваше ім'я"/></div>
          <div class="fld"><label>E‑mail</label><input required type="email" name="email" placeholder="name@example.com"/></div>
          <div class="fld"><label>Телефон</label><input name="phone" placeholder="+420..."/></div>
          <div class="fld"><label>Бажаний контакт</label>
            <select name="preferred_contact">
              <option>e‑mail</option>
              <option>телефон</option>
              <option>WhatsApp/Viber</option>
            </select>
          </div>
          <label class="agree"><input type="checkbox" required /> Згода на обробку персональних даних</label>
          <button class="submit" type="submit">Отримати рекомендацію</button>
          <div class="note">Натискаючи кнопку, ви надсилаєте відповіді та контакти нашому аналітику.</div>
          <div id="ok" class="success">Дякуємо! Ми отримали ваші дані. Перевірте пошту — надішлемо рекомендацію.</div>
        </form>
      `;

      els.result.classList.add('show');

      // Formspree без перезавантаження (опційно)
      const form = document.getElementById('leadForm');
      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const fd = new FormData(form);
        try{
          const r = await fetch(form.action, {method:'POST', body:fd, headers:{'Accept':'application/json'}});
          if(r.ok){ form.reset(); document.getElementById('ok').style.display='block'; }
        }catch(err){ console.error(err); }
      });
    }

    // Експортуємо у глобальний скоуп для inline onclick
    window.openQuiz  = openQuiz;
    window.closeQuiz = closeQuiz;
    window.nextStep  = nextStep;
    window.prevStep  = prevStep;

    // ===================== DEV SELF‑TESTS =====================
    // Запустити, якщо у URL є ?test=1
    function runSelfTests(){
      const tests = [];
      const assert = (name, cond)=>{ tests.push({name, pass:!!cond}); if(!cond){ console.error('[TEST FAIL]', name); } };

      assert('openQuiz exists', typeof window.openQuiz === 'function');
      assert('nextStep exists', typeof window.nextStep === 'function');

      // Відкриваємо квіз і перевіряємо DOM
      window.openQuiz();
      assert('Quiz is visible', els.quiz.getAttribute('aria-hidden') === 'false');
      assert('Question rendered', !!document.querySelector('.quiz__q'));

      // Симуляція кроку
      const firstRadio = document.querySelector('.quiz__answers input[type=radio]');
      if(firstRadio){ firstRadio.click(); window.nextStep(); }
      assert('Progress updated', parseInt(els.progress.style.width) >= 0);

      // Прибираємо за собою
      window.closeQuiz();

      // Вивід резюме
      const banner = document.createElement('div');
      banner.id='test-banner';
      banner.style='position:fixed;right:10px;bottom:10px;background:#111;color:#fff;padding:8px 12px;border-radius:8px;z-index:9999;opacity:.92;font:12px/1.2 Inter,system-ui';
      const pass = tests.filter(t=>t.pass).length;
      banner.textContent = `Self‑tests: ${pass}/${tests.length} passed`;
      document.body.appendChild(banner);
    }

    if(location.search.includes('test=1')){
      if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', runSelfTests); else runSelfTests();
    }
  })();
  </script>
</body>
</html>
