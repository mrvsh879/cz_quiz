<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Новий стиль в інвестуванні — MVP</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#4712a3;
      --accent:#4f46e5;
      --accent-2:#22c55e;
      --text:#0b1020;
      --muted:#6b7280;
      --card:#ffffff;
      --ring:rgba(79,70,229,.2);
      --shadow:0 10px 25px rgba(2,6,23,.18), 0 2px 6px rgba(2,6,23,.12);
      --radius:18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;color:var(--text);background:#fff}

    /* === HERO FULLSCREEN === */
    .hero{position:relative;display:flex;align-items:center;justify-content:center;min-height:100vh;background:var(--bg);color:#fff}
    .hero__wrap{width:100%;padding:48px 40px;text-align:center}
    .headline .row{display:flex;gap:18px;align-items:center;justify-content:center;flex-wrap:wrap}
    .word{font-weight:900;letter-spacing:.02em;text-transform:uppercase;font-size:clamp(48px,9vw,140px);line-height:1}
    .big{display:block;font-weight:900;text-transform:uppercase;font-size:clamp(48px,9vw,140px);line-height:1.02;margin-top:8px}
    .pill{display:inline-block;padding:12px 18px;background:#fff;border-radius:16px;color:#3b0ea2;font-weight:800;font-size:clamp(12px,1.8vw,22px);white-space:nowrap}
    .hero__actions{display:flex;gap:14px;align-items:center;justify-content:center;margin-top:28px;flex-wrap:wrap}
    .btn-primary{background:#fff;color:#111;font-weight:900;border-radius:16px;padding:16px 22px;cursor:pointer;border:none}
    .btn-outline{background:transparent;border:2px solid rgba(255,255,255,.7);color:#fff;border-radius:16px;padding:14px 20px;text-decoration:none}

    @media (max-width: 900px){
      .hero__wrap{padding:36px 18px}
      .pill{border-radius:14px}
    }

    /* === QUIZ MODAL (full-screen) === */
    .quiz{position:fixed;inset:0;display:none;z-index:70}
    .quiz[aria-hidden="false"]{display:block}
    .quiz__backdrop{position:absolute;inset:0;background:rgba(17,24,39,.56);backdrop-filter:blur(4px)}
    .quiz__panel{position:absolute;inset:20px;display:grid;grid-template-rows:auto auto 1fr auto;gap:16px;background:var(--bg);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .quiz__top{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 18px;background:transparent;border-bottom:1px dashed rgba(255,255,255,.18)}
    .quiz__title{font-weight:800;color:#ffffff}
    .quiz__progress-wrap{height:10px;background:#eef2ff;border-radius:999px;overflow:hidden;margin:0 18px}
    .quiz__progress{height:100%;width:0;background:var(--accent-2);transition:width .25s ease}

    .quiz__card{margin:12px 14px;background:var(--card);border-radius:16px;box-shadow:var(--shadow);padding:6px 6px 18px}
    .quiz__q{padding:22px 24px;border-bottom:1px dashed #e5e7eb;font-weight:800;text-align:center;font-size:clamp(20px,2.6vw,28px);line-height:1.25}
    .quiz__answers{display:grid;gap:16px;padding:18px;grid-template-columns:1fr 1fr}
    .opt{display:flex;align-items:center;gap:14px;min-height:84px;padding:18px 22px;border:1.5px solid #e5e7eb;border-radius:14px;cursor:pointer;transition:border-color .2s,box-shadow .2s,transform .1s;background:#fff;font-size:20px}
    .opt.selected{border-color:var(--accent);box-shadow:0 0 0 4px var(--ring)}
    .opt input{width:22px;height:22px;margin-top:2px} .opt span{flex:1}
    .opt:hover{border-color:var(--accent);box-shadow:0 0 0 4px var(--ring)}

    .quiz__footer{display:flex;justify-content:space-between;gap:12px;padding:14px 18px;background:#fff;border-top:1px dashed rgba(2,6,23,.08)}
    .btn-sec{border:1.5px solid #c7ccff;background:#eef2ff;color:#27309a;border-radius:12px;padding:14px 18px;cursor:pointer}
    .btn-prim{background:var(--accent);color:#fff;border-radius:12px;padding:14px 18px;border:none;cursor:pointer}
    .quiz__nav{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    .quiz__footer .btn{min-width:160px}
    .quiz__nav .btn{min-width:140px}

    /* === RESULT + FORM === */
    .result{margin:12px 14px;background:#fff;border-radius:16px;box-shadow:var(--shadow);padding:16px;display:none}
    .result.show{display:block}
    .resultHead{padding:28px 16px 8px;text-align:center}
    .resultHead h2{display:inline-block;margin:0;font-weight:900;font-size:clamp(28px,3.2vw,42px);line-height:1.1;color:#1f235a}
    .resultHead p{margin:12px auto 22px;max-width:960px;color:#374151;font-size:clamp(15px,1.4vw,18px)}
    .divider{height:3px;background:linear-gradient(90deg,#3b0ea2,#8b5cf6,#3b0ea2);opacity:.85;border-radius:999px;margin:6px 8px 16px}

    form{display:grid;gap:12px;margin-top:8px}
    .fld{display:flex;flex-direction:column;gap:6px}
    .fld label{font-size:13px;color:#334155}
    .fld input,.fld select{padding:12px 14px;border:1.4px solid #d1d5db;border-radius:12px;font:inherit}
    .agree{display:flex;align-items:center;gap:10px;font-size:12px;color:#475569}
    .submit{padding:14px 18px;border-radius:12px;background:linear-gradient(90deg,#4f46e5,#7c3aed);border:0;color:#fff;font-weight:800;cursor:pointer;box-shadow:var(--shadow)}
    .note{font-size:12px;color:#64748b}
    .success{display:none;padding:12px 14px;background:#ecfdf5;border:1px solid #a7f3d0;border-radius:12px;color:#065f46;font-weight:600}

    @media (max-width: 980px){
      .quiz__panel{inset:10px}
      .quiz__nav .btn, .quiz__footer .btn{flex:1}
      .quiz__answers{grid-template-columns:1fr}
      .opt{min-height:72px;font-size:18px}
    }
  </style>
</head>
<body>
  <!-- ================= HERO ================= -->
  <main class="hero">
    <section class="hero__wrap">
      <div class="headline">
        <div class="row">
          <span class="word">НОВИЙ СТИЛЬ</span>
          <span class="pill">партнерська програма</span>
        </div>
        <span class="big">ІНВЕСТУВАННЯ</span>
      </div>
      <div class="hero__actions">
        <button class="btn-primary" onclick="openQuiz()">Хочу інвестувати безпечно</button>
        <a class="btn-outline" href="#advantages">Переваги</a>
      </div>
    </section>
  </main>

  <!-- =============== QUIZ FULLSCREEN =============== -->
  <div id="quiz" class="quiz" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="quiz__backdrop" onclick="closeQuiz()" aria-label="Закрити"></div>
    <div class="quiz__panel">
      <div class="quiz__top">
        <div class="quiz__title">Швидкий тест: знайдемо для вас безпечний план</div>
        <div class="quiz__nav">
          <button id="prevBtnTop" class="btn btn-sec" onclick="prevStep()" disabled>Назад</button>
          <button id="nextBtnTop" class="btn btn-prim" onclick="nextStep()">Далі</button>
          <button class="btn btn-sec" onclick="closeQuiz()">✕</button>
        </div>
      </div>
      <div class="quiz__progress-wrap" aria-hidden="true"><div id="progress" class="quiz__progress"></div></div>

      <!-- QUESTION CARD -->
      <div id="card" class="quiz__card" aria-live="polite"></div>

      <!-- RESULT + FORM -->
      <div id="result" class="result" aria-live="polite"></div>

      <div class="quiz__footer">
        <button id="prevBtn" class="btn btn-sec" onclick="prevStep()" disabled>Назад</button>
        <div style="display:flex;gap:8px">
          <button id="nextBtn" class="btn btn-prim" onclick="nextStep()">Далі</button>
        </div>
      </div>
    </div>
  </div>

  <script>
  // ================= QUIZ LOGIC (IIFE + window exports) =================
  (function(){
    const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xldpbqkv';

    const steps = [
      { q: '1) Скільки вам років?', name:'age', type:'radio', options:['від 20 до 40','від 40 до 75','75+'] },
      { q: '2) Чи можливо заробити на відпустку через інвестиції?', name:'vac', type:'radio', options:['можливо','не віриться','вже заробив, хочу ще'] },
      { q: '3) Що зараз вигідно купити для заробітку?', name:'asset', type:'radio', options:['золото','акції молодої компанії','хочу дізнатися у вас'] },
      { q: '4) Як правильно обрати партнера для інвестицій?', name:'partner', type:'radio', options:['перевірити документи','інвестувати маленьку суму','проконсультуватися з професіоналами','хочу дізнатися'] }
    ];

    let idx = 0;
    const state = {};

    const els = {
      quiz: document.getElementById('quiz'),
      card: document.getElementById('card'),
      result: document.getElementById('result'),
      progress: document.getElementById('progress'),
      prevBtn: document.getElementById('prevBtn'),
      nextBtn: document.getElementById('nextBtn'),
      prevBtnTop: document.getElementById('prevBtnTop'),
      nextBtnTop: document.getElementById('nextBtnTop')
    };

    function resetState(){ for(const k in state) delete state[k]; }

    function openQuiz(){
      els.quiz.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
      idx = 0; resetState();
      els.nextBtn.style.display = '';
      els.prevBtn.style.display = '';
      els.card.style.display = '';
      els.progress.style.width = '0%';
      renderStep();
    }

    function closeQuiz(){
      els.quiz.setAttribute('aria-hidden','true');
      document.body.style.overflow='auto';
    }

    function renderStep(){
      const step = steps[idx];
      els.result.classList.remove('show');

      const pct = Math.round((idx) / steps.length * 100);
      els.progress.style.width = pct + '%';

      const isFirst = idx === 0;
      const isLast  = idx === steps.length - 1;
      els.prevBtn.disabled    = isFirst;
      els.prevBtnTop.disabled = isFirst;
      const nextText = isLast ? 'Показати результат' : 'Далі';
      els.nextBtn.textContent    = nextText;
      els.nextBtnTop.textContent = nextText;

      const saved = state[step.name] ?? '';
      const opts = step.options.map((t,i)=>{
        const id = step.name + '_' + i;
        const checked = saved === t ? 'checked' : '';
        return `
          <label class="opt" for="${id}">
            <input id="${id}" type="radio" name="${step.name}" value="${t}" ${checked} />
            <span>${t}</span>
          </label>`;
      }).join('');

      els.card.innerHTML = `
        <div class="quiz__q">${step.q}</div>
        <div class="quiz__answers">${opts}</div>`;

      els.card.querySelectorAll('label.opt').forEach(label=>{
        const inp = label.querySelector('input[type="radio"]');
        if(inp.value === saved){ label.classList.add('selected'); }
        inp.addEventListener('change', ()=>{
          els.card.querySelectorAll('label.opt').forEach(l=>l.classList.remove('selected'));
          label.classList.add('selected');
          state[step.name] = inp.value;
        });
      });

      const first = els.card.querySelector('input');
      first && first.focus({preventScroll:true});
    }

    function nextStep(){
      const step = steps[idx];
      if(!state[step.name]){ bump(); return; }
      if(idx < steps.length - 1){ idx++; renderStep(); return; }
      showResult();
    }

    function prevStep(){ idx = Math.max(0, idx - 1); renderStep(); }

    function bump(){
      [els.nextBtn, els.nextBtnTop].forEach(btn=>{
        if(!btn) return;
        btn.animate([
          {transform:'translateY(0)'},
          {transform:'translateY(-2px)'},
          {transform:'translateY(0)'}
        ],{duration:240});
      });
    }

    function profileFrom(state){
      let score = 0;
      if(state.age === 'від 40 до 75' || state.age === '75+') score += 1;
      if(state.asset === 'золото') score += 2;
      if(state.asset === 'акції молодої компанії') score -= 1;
      if(state.partner === 'перевірити документи') score += 1;
      if(state.partner === 'проконсультуватися з професіоналами') score += 1;

      if(score >= 3) return {key:'conservative', title:'Консервативний профіль',
        rec:'Рекомендуємо консервативну стратегію: облігації, фонди нерухомості, золото/срібло. Поступове збільшення частки акцій після консультації.'}
      if(score <= 0) return {key:'aggr', title:'Помірно-агресивний профіль',
        rec:'Можливе поєднання індексних фондів та частки акцій зростання. Захист: 30–40% у «якорях» (золото/облігації).'}
      return {key:'moderate', title:'Збалансований профіль',
        rec:'Збалансований портфель: 50–60% індексні фонди/великі компанії, 20–30% облігації, 10–20% метали. Регулярний ребаланс.'}
    }

    function showResult(){
      els.card.innerHTML = '';
      els.card.style.display = 'none';
      els.nextBtn.style.display = 'none';
      els.prevBtn.style.display = 'none';
      if(els.nextBtnTop) els.nextBtnTop.style.display = 'none';
      if(els.prevBtnTop) els.prevBtnTop.style.display = 'none';
      els.progress.style.width = '100%';

      const prof = profileFrom(state);
      const hiddenPayload = Object.entries(state)
        .map(([k,v])=>`<input type="hidden" name="${k}" value="${v}">`).join('') +
        `<input type="hidden" name="profile" value="${prof.title}">`;

      els.result.innerHTML = `
        <div class="resultHead">
          <h2>${prof.title}</h2>
          <p>${prof.rec}</p>
        </div>
        <div class="divider" aria-hidden="true"></div>
        <form id="leadForm" action="#" method="POST">
          ${hiddenPayload}
          <input type="hidden" name="_subject" value="Результат квізу — ${prof.title}">
          <input type="hidden" name="_template" value="table">
          <input type="text" name="_gotcha" style="display:none" tabindex="-1" autocomplete="off">
          <div class="fld"><label>Ім'я та прізвище</label><input required name="full_name" placeholder="Ваше ім'я"/></div>
          <div class="fld"><label>E-mail</label><input required type="email" name="email" placeholder="name@example.com"/></div>
          <div class="fld"><label>Телефон</label><input name="phone" placeholder="+420..."/></div>
          <div class="fld"><label>Бажаний контакт</label>
            <select name="preferred_contact">
              <option>e-mail</option>
              <option>телефон</option>
              <option>WhatsApp/Viber</option>
            </select>
          </div>
          <label class="agree"><input type="checkbox" required /> Згода на обробку персональних даних</label>
          <button class="submit" type="submit">Отримати рекомендацію</button>
          <div class="note">Натискаючи кнопку, ви надсилаєте відповіді та контакти нашому аналітику.</div>
          <div id="ok" class="success">Дякуємо! Ми отримали ваші дані. Перевірте пошту — надішлемо рекомендацію.</div>
          <div id="err" class="success" style="display:none;background:#fff1f2;border-color:#fecdd3;color:#9f1239">Сталася помилка при відправці. Спробуйте ще раз або напишіть нам листа.</div>
        </form>
      `;

      els.result.classList.add('show');

      const form = document.getElementById('leadForm');
      form.action = FORMSPREE_ENDPOINT;
      form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const btn = form.querySelector('.submit');
        const ok  = document.getElementById('ok');
        const er  = document.getElementById('err');
        ok.style.display='none'; er.style.display='none';
        btn.disabled = true; btn.textContent = 'Відправляємо…';
        const fd = new FormData(form);
        try{
          const r = await fetch(form.action, {method:'POST', body:fd, headers:{'Accept':'application/json'}});
          if(r.ok){ form.reset(); ok.style.display='block'; }
          else { er.style.display='block'; }
        }catch(err){ console.error(err); er.style.display='block'; }
        finally{ btn.disabled=false; btn.textContent='Отримати рекомендацію'; }
      });
    }

    // exports
    window.openQuiz  = openQuiz;
    window.closeQuiz = closeQuiz;
    window.nextStep  = nextStep;
    window.prevStep  = prevStep;

    // ===== Optional self-tests: add ?test=1 to URL =====
    function runSelfTests(){
      const tests = [];
      const assert = (name, cond)=>{ tests.push({name, pass:!!cond}); if(!cond){ console.error('[TEST FAIL]', name); } };
      assert('openQuiz exists', typeof window.openQuiz === 'function');
      assert('closeQuiz exists', typeof window.closeQuiz === 'function');
      assert('nextStep exists', typeof window.nextStep === 'function');
      assert('prevStep exists', typeof window.prevStep === 'function');
      window.openQuiz();
      assert('Quiz visible', document.getElementById('quiz').getAttribute('aria-hidden') === 'false');
      assert('Question rendered', !!document.querySelector('.quiz__q'));
      window.closeQuiz();
      const banner = document.createElement('div');
      banner.style='position:fixed;right:10px;bottom:10px;background:#111;color:#fff;padding:8px 12px;border-radius:8px;z-index:9999;font:12px/1.2 Inter,system-ui';
      banner.textContent = 'Self-tests done';
      document.body.appendChild(banner);
    }
    if(location.search.includes('test=1')){
      if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', runSelfTests); else runSelfTests();
    }
  })();
  </script>
</body>
</html>
